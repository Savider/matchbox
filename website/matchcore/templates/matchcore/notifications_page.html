{% extends "matchcore/layout_nav.html" %}
{% load static %}

{% block main %}

<div class="container">
	<h1 class="mt-5">Unread messages</h1>
	<div class="message-list">
		<!-- Message -->
		{% for n in unread_notifications %}
			<div class="row unread-message">
				{% if n.type == 'RS' %}
					<div class="col-8">
						<strong>{{n.sender.user.username}}</strong> {%if n.accepted%}accepted {%else%}rejected {%endif%} your request to join the project <strong>{{n.project.title}}</strong>
					</div>
					<div class="col message-buttons">
						<a href="{% url 'project_page' n.project.id %}" class="message-button btn btn-text"><img class="prj" src="{% static 'matchcore/images/project.svg' %}"></a>
						<div class="message-button-desc"><a href="{% url 'project_page' n.project.id %}">Check project</a></div>
					</div>
				{% else %}
					<div class="col-8">
						<strong>{{n.sender.user.username}}</strong> wants to join your project <strong>{{n.project.title}}</strong>
					</div>
					<div class="col message-buttons">
						<a href="{% url 'user_page' n.sender.user.username %}" class="message-button btn btn-text"><img class="prf" src="{% static 'matchcore/images/profile.svg' %}"></a>
						<form action="/accept_request" method="post">
							{% csrf_token %}
							<button class="message-button btn btn-text" name="notification_id" value="{{n.id}}"><img class="accrj" src="{% static 'matchcore/images/accept.svg' %}"></button>
						</form>
						<form action="/reject_request" method="post">
							{% csrf_token %}
							<button class="message-button btn btn-text" name="notification_id" value="{{n.id}}"><img class="accrj" src="{% static 'matchcore/images/reject.svg' %}"></button>
						</form>
					</div>
				{% endif %}
			</div>
		{% endfor %}
	</div>

	<h1 class="mt-5">Read messages</h1>
	<div class="message-list">
		<!-- Message -->
		{% for n in read_notifications %}
		<div class="row read-message">
			{% if n.type == 'RS' %}
				<div class="col-8">
					<strong>{{n.sender.user.username}}</strong> {%if n.accepted%}accepted {%else%}rejected {%endif%} your request to join the project <strong>{{n.project.title}}</strong>
				</div>
				<div class="col message-buttons">
					<a href="{% url 'project_page' n.project.id %}" class="message-button btn btn-primary"><img class="prj" src="{% static 'matchcore/images/project_white.svg' %}"></a>
					<div class="message-button-desc"><a href="{% url 'project_page' n.project.id %}">Check project</a></div>
				</div>
			{% else %}
				{% if n.interacted %}
					<div class="col-8">
						You <strong>{%if n.accepted%}accepted {%else%}rejected {%endif%}</strong> the request of <strong>{{n.sender.user.username}}</strong> to join your project <strong>{{n.project.title}}</strong>
					</div>
					<div class="col message-buttons">
						<a href="{% url 'user_page' n.sender.user.username %}" class="message-button btn btn-primary"><img class="prf" src="{% static 'matchcore/images/profile_white.svg' %}"></a>
						<div class="message-button-desc"><a href="{% url 'user_page' n.sender.user.username %}">Check profile</a></div>
					</div>
				{% else %}
					<div class="col-8">
							<strong>{{n.sender.user.username}}</strong> wants to join your project <strong>{{n.project.title}}</strong>
						</div>
						<div class="col message-buttons">
							<a href="{% url 'user_page' n.sender.user.username %}" class="message-button btn btn-primary"><img class="prf" src="{% static 'matchcore/images/profile_white.svg' %}"></a>
							<form action="/accept_request" method="post">
								{% csrf_token %}
								<button class="message-button btn btn-primary" name="notification_id" value="{{n.id}}"><img class="accrj" src="{% static 'matchcore/images/accept_white.svg' %}"></button>
							</form>
							<form action="/reject_request" method="post">
								{% csrf_token %}
								<button class="message-button btn btn-primary" name="notification_id" value="{{n.id}}"><img class="accrj" src="{% static 'matchcore/images/reject_white.svg' %}"></button>
							</form>
						</div>
				{% endif %}
			{% endif %}
		</div>
		{% endfor %}
	</div>
</div>

{% endblock %}

<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<p>Unread Notifications:</p>
{% for n in unread_notifications %}
<p>{{n.type}}</p>
<p>{{n.project.title}}</p>
<p>{{n.sender.user.username}}</p>
{% endfor %}
<p>Read Notifications:</p>
{% for n in read_notifications %}
<p>{{n.type}}</p>
<p>{{n.project.title}}</p>
<p>{{n.sender.user.username}}</p>
{% endfor %}
</body>
</html> -->